<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Progress Test - Color Rush</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            color: white;
        }
        
        .test-controls {
            margin: 20px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .test-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .score-display {
            font-size: 24px;
            margin: 20px 0;
            text-align: center;
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
        }
        
        .progress-demo {
            margin: 30px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üåü Star Progress System Test</h1>
        <p>Test the star progress panel that fills up as you gain points!</p>
        
        <div class="score-display">
            <div class="score">Score: 0</div>
        </div>
        
        <div class="progress-demo">
            <!-- Star Progress Panel (copied from main game) -->
            <div class="progress-panel">
                <h3 class="panel-title">üìä Progress</h3>
                
                <!-- Star Progress -->
                <div class="star-progress">
                    <div class="progress-header">
                        <span>Stars</span>
                        <span class="stars-earned">0/3</span>
                    </div>
                    <div class="progress-bar">
                        <div class="star-progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="star-indicators">
                        <span class="star-icon inactive" data-star="1">‚≠ê</span>
                        <span class="star-icon inactive" data-star="2">‚≠ê</span>
                        <span class="star-icon inactive" data-star="3">‚≠ê</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="test-controls">
            <button class="test-btn" onclick="addScore(100)">+100 Points</button>
                        <button class="test-btn" onclick="addScore(500)">+500 Points</button>            <button class="test-btn" onclick="addScore(1000)">+1000 Points</button>            <button class="test-btn" onclick="setScore(3200)">Set to 40% (1 Star)</button>            <button class="test-btn" onclick="setScore(5600)">Set to 70% (2 Stars)</button>            <button class="test-btn" onclick="setScore(8000)">Set to 100% (3 Stars)</button>            <button class="test-btn" onclick="resetScore()">Reset Score</button>
        </div>
        
                <div style="margin-top: 30px; padding: 20px; background: rgba(0,0,0,0.2); border-radius: 10px;">            <h3>Star Thresholds (Adventure Level 1):</h3>            <ul>                <li>‚≠ê First Star: 3,200 points (40% completion)</li>                <li>‚≠ê‚≠ê Second Star: 5,600 points (70% completion)</li>                <li>‚≠ê‚≠ê‚≠ê Third Star: 8,000 points (100% completion)</li>            </ul>
            <p><strong>Features:</strong></p>
            <ul>
                <li>‚ú® Smooth progress bar animation</li>
                <li>üéâ Star earned celebration popup</li>
                <li>üí° Hover tooltip showing points needed</li>
                <li>üåü Individual star activation with sparkle effect</li>
            </ul>
        </div>
    </div>

    <script>
                // Simplified game state for testing (Adventure Level 1)        const gameState = {            score: 0,            starsEarned: 0,            starThresholds: [3200, 5600, 8000], // 40%, 70%, 100% of level target (8000) - Rebalanced            adventureLevel: 1,            currentObjective: { type: 'score', target: 8000 }        };

        function addScore(points) {
            const previousStars = calculateCurrentStars();
            gameState.score += points;
            updateScoreDisplay();
            updateStarProgress();
            
            // Check for new star and show celebration
            const currentStars = calculateCurrentStars();
            if (currentStars > previousStars) {
                showStarEarnedAnimation(currentStars);
            }
        }

        function setScore(points) {
            const previousStars = calculateCurrentStars();
            gameState.score = points;
            updateScoreDisplay();
            updateStarProgress();
            
            // Check for new star and show celebration
            const currentStars = calculateCurrentStars();
            if (currentStars > previousStars) {
                showStarEarnedAnimation(currentStars);
            }
        }

        function resetScore() {
            gameState.score = 0;
            gameState.starsEarned = 0;
            
            // Reset star animations
            const starIcons = document.querySelectorAll('.star-icon');
            starIcons.forEach(star => {
                star.dataset.animated = 'false';
            });
            
            updateScoreDisplay();
            updateStarProgress();
        }

        function updateScoreDisplay() {
            const scoreElement = document.querySelector('.score');
            if (scoreElement) {
                scoreElement.textContent = `Score: ${gameState.score.toLocaleString()}`;
            }
        }

        function calculateCurrentStars() {
            const currentScore = gameState.score;
            const thresholds = gameState.starThresholds;
            
            if (currentScore >= thresholds[2]) return 3;
            if (currentScore >= thresholds[1]) return 2;
            if (currentScore >= thresholds[0]) return 1;
            return 0;
        }

        function updateStarProgress() {
            const currentScore = gameState.score;
            const thresholds = gameState.starThresholds;
            
            // Calculate current stars earned
            let starsEarned = 0;
            if (currentScore >= thresholds[2]) starsEarned = 3;
            else if (currentScore >= thresholds[1]) starsEarned = 2;
            else if (currentScore >= thresholds[0]) starsEarned = 1;
            
            // Update stars earned display
            const starsEarnedElement = document.querySelector('.stars-earned');
            if (starsEarnedElement) {
                starsEarnedElement.textContent = `${starsEarned}/3`;
            }
            
            // Calculate progress percentage for the progress bar
            let progressPercentage = 0;
            let nextThreshold = thresholds[0];
            
            if (currentScore >= thresholds[2]) {
                progressPercentage = 100;
                        } else if (currentScore >= thresholds[1]) {                // Between star 2 and star 3 (70% to 100%)                const progressBetweenStars = (currentScore - thresholds[1]) / (thresholds[2] - thresholds[1]);                progressPercentage = 70 + (progressBetweenStars * 30);                nextThreshold = thresholds[2];            } else if (currentScore >= thresholds[0]) {                // Between star 1 and star 2 (40% to 70%)                const progressBetweenStars = (currentScore - thresholds[0]) / (thresholds[1] - thresholds[0]);                progressPercentage = 40 + (progressBetweenStars * 30);                nextThreshold = thresholds[1];            } else {                // Before first star (0% to 40%)                progressPercentage = (currentScore / thresholds[0]) * 40;                nextThreshold = thresholds[0];            }
            
            // Update progress bar
            const progressFill = document.querySelector('.star-progress-fill');
            if (progressFill) {
                progressFill.style.width = `${Math.min(progressPercentage, 100)}%`;
                
                // Add smooth animation
                progressFill.style.transition = 'width 0.5s ease-out';
            }
            
            // Update individual star indicators
            const starIcons = document.querySelectorAll('.star-icon');
            starIcons.forEach((starIcon, index) => {
                const starNumber = index + 1;
                if (starNumber <= starsEarned) {
                    starIcon.classList.remove('inactive');
                    starIcon.classList.add('active');
                    // Add sparkle animation for newly earned stars
                    if (starNumber === starsEarned && starIcon.dataset.animated !== 'true') {
                        starIcon.style.animation = 'starEarned 0.8s ease-out';
                        starIcon.dataset.animated = 'true';
                        setTimeout(() => {
                            starIcon.style.animation = '';
                        }, 800);
                    }
                } else {
                    starIcon.classList.add('inactive');
                    starIcon.classList.remove('active');
                    starIcon.dataset.animated = 'false';
                }
            });
            
            // Update gameState
            gameState.starsEarned = starsEarned;
            
            // Show progress tooltip on hover
            updateProgressTooltip(currentScore, nextThreshold, starsEarned);
        }

        function updateProgressTooltip(currentScore, nextThreshold, starsEarned) {
            const starProgress = document.querySelector('.star-progress');
            if (!starProgress) return;
            
            // Remove existing tooltip
            const existingTooltip = starProgress.querySelector('.progress-tooltip');
            if (existingTooltip) {
                existingTooltip.remove();
            }
            
            // Create new tooltip
            const tooltip = document.createElement('div');
            tooltip.className = 'progress-tooltip';
            tooltip.style.cssText = `
                position: absolute;
                bottom: 100%;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 8px 12px;
                border-radius: 6px;
                font-size: 12px;
                white-space: nowrap;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.3s ease;
                z-index: 1000;
            `;
            
                        if (starsEarned === 3) {                tooltip.textContent = `Perfect! Level 100% completed! üåü`;            } else {                const pointsNeeded = nextThreshold - currentScore;                const starNumber = starsEarned + 1;                const percentage = starNumber === 3 ? '100%' : starNumber === 2 ? '70%' : '40%';                tooltip.textContent = `${pointsNeeded.toLocaleString()} more points for ${percentage} completion (‚≠ê${starNumber})`;            }
            
            starProgress.appendChild(tooltip);
            
            // Show tooltip on hover
            starProgress.addEventListener('mouseenter', () => {
                tooltip.style.opacity = '1';
            });
            
            starProgress.addEventListener('mouseleave', () => {
                tooltip.style.opacity = '0';
            });
        }

        function showStarEarnedAnimation(starNumber) {
            // Create a celebration popup for earning a new star
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #FFD700, #FFA500);
                color: white;
                padding: 20px 30px;
                border-radius: 15px;
                font-size: 24px;
                font-weight: bold;
                text-align: center;
                z-index: 2000;
                animation: starCelebration 2s ease-out forwards;
                box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
            `;
            
            popup.innerHTML = `
                <div>‚≠ê STAR EARNED! ‚≠ê</div>
                <div style="font-size: 16px; margin-top: 10px;">${'‚òÖ'.repeat(starNumber)} ${starNumber}/3 Stars</div>
            `;
            
            document.body.appendChild(popup);
            
            // Remove popup after animation
            setTimeout(() => {
                if (popup.parentNode) {
                    popup.parentNode.removeChild(popup);
                }
            }, 2000);
        }

        // Initialize the display
        updateScoreDisplay();
        updateStarProgress();
    </script>
</body>
</html> 